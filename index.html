<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Navagraha Prati·π£·π≠hƒÅ Kramam</title>

<style>
:root{
  --bg1:#3b236b;
  --bg2:#5b2a86;
  --bg3:#7a3fa0;
  --card:rgba(255,255,255,.12);
  --text:#ffffff;
  --muted:rgba(255,255,255,.85);
  --good:#22c55e;
  --bad:#ef4444;
  --info:#3b82f6;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--text);
  background:linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
  min-height:100vh;
  padding:10px;
}

/* Keep everything compact on phones */
.wrap{max-width:920px;margin:0 auto}

h1{
  font-size:26px;
  font-weight:900;
  margin:6px 0 2px;
  line-height:1.1;
}

.subtitle{
  font-size:14px;
  color:var(--muted);
  margin:0 0 6px;
}

/* Compass (small) */
.compass-wrap{
  display:flex;
  justify-content:center;
  margin:6px 0 10px;
}
.compass-wrap img{
  width:78px;
  max-width:26vw;
  background:white;
  border-radius:50%;
  padding:6px;
  opacity:.92;
}

/* Controls */
.row{
  display:flex;
  gap:8px;
  justify-content:center;
  flex-wrap:wrap;
  margin:6px 0 10px;
}

button{
  font-size:14px;
  font-weight:700;
  padding:9px 12px;
  border-radius:12px;
  border:none;
  cursor:pointer;
  background:rgba(255,255,255,.18);
  color:white;
}
button:hover{background:rgba(255,255,255,.26)}
button:disabled{opacity:.5}

/* Message banner (compact) */
.pill{
  max-width:820px;
  margin:0 auto 10px;
  padding:9px 10px;
  border-radius:14px;
  font-size:14px;
  text-align:center;
  line-height:1.25;
}
.pill.good{background:rgba(34,197,94,.30)}
.pill.bad{background:rgba(239,68,68,.30)}
.pill.info{background:rgba(59,130,246,.30)}

/* Cards */
.card{
  background:var(--card);
  border-radius:18px;
  padding:10px;
  margin-bottom:10px;
}

.title{
  font-size:15px;
  font-weight:800;
  text-align:center;
  margin:2px 0 8px;
}

/* Board (smaller tiles) */
.board{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
  max-width:360px;
  margin:0 auto;
}

.slot{
  aspect-ratio:1/1;
  border-radius:14px;
  border:2px dashed rgba(255,255,255,.45);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  position:relative;
  overflow:hidden;
}

.slot.filled{
  border-style:solid;
  border-color:rgba(34,197,94,.62);
}

.slot.correct{
  box-shadow:0 0 0 3px rgba(34,197,94,.40);
}

.inner{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:3px;
  font-weight:900;
  color:#111827;
}

.planet{font-size:28px; line-height:1}
.name{font-size:13px; line-height:1.1}

/* Pool grid compact */
.pool{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
  max-width:760px;
  margin:0 auto;
}
@media (min-width:640px){
  .pool{grid-template-columns:repeat(5,1fr)}
}

.piece{
  aspect-ratio:1/1;
  border-radius:14px;
  border:2px solid rgba(255,255,255,.58);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  position:relative;
  overflow:hidden;
}

.piece.selected{
  box-shadow:0 0 0 3px rgba(34,197,94,.55);
}

/* Direction badge (top-left) */
.dir-badge{
  position:absolute;
  top:6px;
  left:6px;
  font-size:10px;
  font-weight:900;
  letter-spacing:.4px;
  padding:3px 6px;
  border-radius:999px;
  background:rgba(0,0,0,.35);
  color:#fff;
  line-height:1;
  user-select:none;
}

/* Make direction labels readable on very light tiles */
.dir-badge.light{
  background:rgba(0,0,0,.42);
}

.footer{
  text-align:center;
  font-size:11px;
  margin-top:6px;
  color:rgba(255,255,255,.82);
}

/* Extra: reduce vertical density even more on short screens */
@media (max-height: 720px){
  .compass-wrap img{ width:70px; padding:5px; }
  .board{ max-width:330px; gap:7px; }
  .pool{ gap:7px; }
  .card{ padding:9px; margin-bottom:9px; }
}
</style>
</head>

<body>
<div class="wrap">

  <div style="text-align:center">
    <h1>Navagraha Prati·π£·π≠hƒÅ Kramam</h1>
    <div class="subtitle">Learn the correct temple installation positions of the Navagrahas</div>
  </div>

  <div class="compass-wrap">
    <img src="compass.png" alt="Compass showing North South East West">
  </div>

  <div class="row">
    <button id="shuffle">üîÄ Shuffle</button>
    <button id="reset">üîÑ Reset</button>
    <button id="cancel" style="display:none">‚úñ Cancel</button>
  </div>

  <div id="message" class="pill" style="display:none"></div>

  <div class="card">
    <div class="title">Prati·π£·π≠hƒÅ Ma·πá·∏çala (3√ó3)</div>
    <div id="board" class="board"></div>
  </div>

  <div class="card">
    <div class="title">Available Grahas</div>
    <div id="pool" class="pool"></div>
  </div>

  <div class="footer">Designed for learning ‚Ä¢ Shareable via WhatsApp ‚Ä¢ No installation required</div>
</div>

<script>
// Piece IDs:
// 0 Guru, 1 Shukra, 2 Budha, 3 Mangala, 4 Surya, 5 Shani, 6 Chandra, 7 Rahu, 8 Ketu
const deities = [
  { id:0, name:'Guru',    planet:'‚ôÉ', color:'#FFB84D' },
  { id:1, name:'Shukra',  planet:'‚ôÄ', color:'#FFF4A3' },
  { id:2, name:'Budha',   planet:'‚òø', color:'#90EE90' },
  { id:3, name:'Mangala', planet:'‚ôÇ', color:'#FF6B6B' },
  { id:4, name:'Surya',   planet:'‚òâ', color:'#FFD700' },
  { id:5, name:'Shani',   planet:'‚ôÑ', color:'#4169E1' },
  { id:6, name:'Chandra', planet:'‚òΩ', color:'#E6E6FA' },
  { id:7, name:'Rahu',    planet:'‚òä', color:'#8B4513' },
  { id:8, name:'Ketu',    planet:'‚òã', color:'#708090' }
];

// Board indices (0..8) are laid out as:
// 0 1 2
// 3 4 5
// 6 7 8
// Your requested mandala:
// NW Rahu, N Shukra, NE Ketu
// W Guru(Brhaspati), C Surya, E Chandra
// SW Shani, S Budha, SE Mangala
const answerKey = [
  7, 1, 8,
  0, 4, 6,
  5, 2, 3
];

// Direction label per board square (for showing on available pieces)
const dirOfBoardIndex = ['NW','N','NE','W','C','E','SW','S','SE'];

// Map pieceId -> its correct board index (where it belongs)
const correctIndexOfPiece = (() => {
  const map = Array(9).fill(null);
  answerKey.forEach((pieceId, boardIdx) => map[pieceId] = boardIdx);
  return map;
})();

// State
let pieces = shuffle([...Array(9).keys()]);
let board = Array(9).fill(null);
let selected = null;

const boardEl = document.getElementById("board");
const poolEl = document.getElementById("pool");
const msgEl = document.getElementById("message");
const cancelBtn = document.getElementById("cancel");

function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}

function show(type,html){
  msgEl.className="pill "+type;
  msgEl.innerHTML=html;
  msgEl.style.display="block";
}
function hide(){ msgEl.style.display="none"; }

function render(){
  boardEl.innerHTML="";
  poolEl.innerHTML="";

  // Board squares
  board.forEach((pieceId, boardIdx)=>{
    const d=document.createElement("div");
    const isCorrect = (pieceId !== null && pieceId === answerKey[boardIdx]);

    d.className = "slot" + (pieceId!==null ? " filled" : "") + (isCorrect ? " correct" : "");

    if(pieceId!==null){
      d.style.background = deities[pieceId].color;
      d.innerHTML = `
        <div class="inner">
          <div class="planet">${deities[pieceId].planet}</div>
          <div class="name">${deities[pieceId].name}</div>
        </div>`;
    }
    d.onclick = () => place(boardIdx);
    boardEl.appendChild(d);
  });

  // Available pieces
  pieces.forEach(pieceId=>{
    const d=document.createElement("div");
    d.className = "piece" + (selected===pieceId ? " selected" : "");
    d.style.background = deities[pieceId].color;

    const correctBoardIdx = correctIndexOfPiece[pieceId];
    const dir = dirOfBoardIndex[correctBoardIdx];

    // add direction badge top-left
    const badge = document.createElement("div");
    badge.className = "dir-badge";
    badge.textContent = dir;

    // Make badge a bit darker on light tiles
    if (pieceId === 1 || pieceId === 6) badge.classList.add("light");

    d.innerHTML = `
      <div class="inner">
        <div class="planet">${deities[pieceId].planet}</div>
        <div class="name">${deities[pieceId].name}</div>
      </div>`;
    d.appendChild(badge);

    d.onclick = () => select(pieceId);
    poolEl.appendChild(d);
  });
}

function select(pieceId){
  if(selected!==null) return;
  selected = pieceId;
  cancelBtn.style.display="inline-block";

  const correctBoardIdx = correctIndexOfPiece[pieceId];
  const dir = dirOfBoardIndex[correctBoardIdx];

  show("info", `Selected: <b>${deities[pieceId].name}</b> <span style="opacity:.9">(goes to <b>${dir}</b>)</span><br>Tap the correct square.`);
  render();
}

function place(boardIdx){
  if(selected===null) return;
  if(board[boardIdx]!==null) return;

  // Correct placement based on answerKey
  if(selected === answerKey[boardIdx]){
    board[boardIdx] = selected;
    pieces = pieces.filter(x => x !== selected);

    selected = null;
    cancelBtn.style.display="none";
    hide();

    const done = board.every((pieceId, idx) => pieceId === answerKey[idx]);
    if(done) show("good", "Perfect Prati·π£·π≠hƒÅ! üéâ");

  } else {
    // Wrong placement: keep selection, do NOT change board/pieces
    show("bad", `Incorrect for <b>${deities[selected].name}</b>. Try another square or Cancel.`);
  }

  render();
}

cancelBtn.onclick = () => {
  selected = null;
  cancelBtn.style.display="none";
  hide();
  render();
};

document.getElementById("reset").onclick = () => {
  pieces = shuffle([...Array(9).keys()]);
  board = Array(9).fill(null);
  selected = null;
  cancelBtn.style.display="none";
  hide();
  render();
};

document.getElementById("shuffle").onclick = () => {
  pieces = shuffle(pieces);
  render();
};

render();
</script>
</body>
</html>
